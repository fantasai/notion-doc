
<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>1 Class and object hierarchies</TITLE>
<META NAME="description" CONTENT="1 Class and object hierarchies">
<META NAME="keywords" CONTENT="notionnotes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="notion.css">

<LINK REL="next" HREF="node3.html">
<LINK REL="previous" HREF="node1.html">
<LINK REL="up" HREF="notionnotes.html">
<LINK REL="next" HREF="node3.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html106"
  HREF="node3.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html100"
  HREF="notionnotes.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html94"
  HREF="node1.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html102"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html104"
  HREF="node10.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html107"
  HREF="node3.html">2 Object system implementation</A>
<B> Up:</B> <A NAME="tex2html101"
  HREF="notionnotes.html">Notion: Notes for the</A>
<B> Previous:</B> <A NAME="tex2html95"
  HREF="node1.html">Contents</A>
 &nbsp; <B>  <A NAME="tex2html103"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html105"
  HREF="node10.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html108"
  HREF="node2.html#SECTION00021000000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN> Class hierarchy</A>
<UL>
<LI><A NAME="tex2html109"
  HREF="node2.html#SECTION00021100000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN> Partial Notioncore, <SPAN  CLASS="textit">mod_tiling</SPAN> and <SPAN  CLASS="textit">mod_query</SPAN> class hierarchy</A>
<LI><A NAME="tex2html110"
  HREF="node2.html#SECTION00021200000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN> The core classes</A>
<LI><A NAME="tex2html111"
  HREF="node2.html#SECTION00021300000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN> Run-time access to types</A>
</UL>
<BR>
<LI><A NAME="tex2html112"
  HREF="node2.html#SECTION00022000000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN> Object hierarchies: WRegion parents and managers</A>
<UL>
<LI><A NAME="tex2html113"
  HREF="node2.html#SECTION00022100000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Parent-child relations</A>
<UL>
<LI><A NAME="tex2html114"
  HREF="node2.html#SECTION00022110000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN> Most common parent-child relations</A>
</UL>
<LI><A NAME="tex2html115"
  HREF="node2.html#SECTION00022200000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN> Manager-managed relations</A>
<UL>
<LI><A NAME="tex2html116"
  HREF="node2.html#SECTION00022210000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Most common manager-managed relations</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html117"
  HREF="node2.html#SECTION00023000000000000000"><SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN> Summary</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00020000000000000000"></A>
<A NAME="sec:objects"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN> Class and object hierarchies
</H1>

<P>
While Notion does not have a truly object-oriented design<A NAME="tex2html5"
  HREF="#foot231"><SUP><SPAN CLASS="arabic">1</SPAN></SUP></A>,
things that appear on the computer screen are, however, quite
naturally expressed as such ``objects''. Therefore Notion implements
a rather primitive OO system for these screen objects and some
other things. 

<P>
It is essential for the module writer to learn this object
system, but also people who write their own binding configuration files
necessarily come into contact with the class and object hierarchies
- you need to know which binding setup routines apply where, 
and what functions can be used as handlers in which bindings.
It is the purpose of this section to attempt to explain these 
hierarchies. If you do not wish the read the full section, at least
read the summary at the end of it, so that you understand the very
basic relations.

<P>
For simplicity we consider only the essential-for-basic-configuration
Notioncore, <SPAN  CLASS="textit">mod_tiling</SPAN> and <SPAN  CLASS="textit">mod_query</SPAN> classes. 
See Appendix <A HREF="node9.html#app:fullhierarchy"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A> for the full class hierarchy visible
to Lua side.

<P>

<H2><A NAME="SECTION00021000000000000000">
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN> Class hierarchy</A>
</H2>

<P>
One of the most important principles of object-oriented design methodology
is inheritance; roughly how classes (objects are instances of classes)
extend on others' features. Inheritance gives rise to class hierarchy.
In the case of single-inheritance this hierarchy can be expressed as a
tree where the class at the root is inherited by all others below it
and so on. The tree below lists out the Notion class hierarchy and below 
we explain what features of Notion the classes implement.

<P>

<H3><A NAME="SECTION00021100000000000000"></A>
<A NAME="subsub:classhierarchy"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN> Partial Notioncore, <SPAN  CLASS="textit">mod_tiling</SPAN> and <SPAN  CLASS="textit">mod_query</SPAN> class hierarchy
</H3>

<P>
<PRE>
    Obj
     |--&gt;WRegion
     |    |--&gt;WClientWin
     |    |--&gt;WWindow
     |    |    |--&gt;WRootWin
     |    |    |--&gt;WMPlex
     |    |    |    |--&gt;WFrame
     |    |    |    `--&gt;WScreen
     |    |    `--&gt;WInput (mod_query)
     |    |         |--&gt;WEdln (mod_query)
     |    |         `--&gt;WMessage (mod_query)
     |    |--&gt;WGroup
     |    |    |--&gt;WGroupWS
     |    |    `--&gt;WGroupCW
     |    `--&gt;WTiling (mod_tiling)
     `--&gt;WSplit (mod_tiling)
</PRE>

<P>

<H3><A NAME="SECTION00021200000000000000">
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN> The core classes</A>
</H3>

<P>
<DL>
<DT><STRONG>Obj</STRONG></DT>
<DD><A NAME="348"></A>
    Is the base of Notion's object system.

<P>
</DD>
<DT><STRONG>WRegion</STRONG></DT>
<DD><A NAME="349"></A>
    is the base class for everything corresponding to something on the
    screen. Each object of type WRegion has a size and  position
    relative to the parent WRegion. While a big part of Notion 
    operates on these instead of more specialised classes, WRegion
    is a ``virtual''  base class in that there are no objects of ``pure''
    type WRegion; all concrete regions are objects of some class 
    that inherits WRegion.

<P>
</DD>
<DT><STRONG>WClientWin</STRONG></DT>
<DD><A NAME="350"></A> is a class for
    client window objects, the objects that window managers are
    supposed to manage.

<P>
</DD>
<DT><STRONG>WWindow</STRONG></DT>
<DD><A NAME="351"></A> is the base class for all
    internal objects having an X window associated to them
    (WClientWins also have X windows associated to them).

<P>
</DD>
<DT><STRONG>WMPlex</STRONG></DT>
<DD>is a base class for all regions that ``multiplex'' 
    other regions. This means that of the regions managed by the multiplexer,
    only one can be displayed at a time. 

<P>
</DD>
<DT><STRONG>WScreen</STRONG></DT>
<DD><A NAME="352"></A> is an instance of WMPlex
    for screens.

<P>
</DD>
<DT><STRONG>WRootWin</STRONG></DT>
<DD><A NAME="353"></A> is the class for
    root windows<A NAME="263"></A> of X screens<A NAME="264"></A>.
    Note that an ``X screen'' or root window is not necessarily a
    single physical screen<A NAME="265"></A> as a root window
    may be split over multiple screens when techniques such as 
    Xinerama<A NAME="266"></A> are used. (Actually there can be only 
    one root window when Xinerama is used.) 

<P>
</DD>
<DT><STRONG>WFrame</STRONG></DT>
<DD><A NAME="354"></A> is the class for frames.
    While most Notion's objects have no graphical presentation, frames 
    basically add to WMPlexes the decorations around client 
    windows (borders, tabs).

<P>
</DD>
<DT><STRONG>WGroup</STRONG></DT>
<DD><A NAME="355"></A> is the base class for groups.
    Particular types of groups are workspaces 
    (WGroupWS<A NAME="356"></A>)
    and groups of client windows
    (WGroupCW<A NAME="357"></A>).
</DD>
</DL>

<P>
Classes implemented by the <SPAN  CLASS="textit">mod_tiling</SPAN> module:

<P>
<DL>
<DT><STRONG>WTiling</STRONG></DT>
<DD><A NAME="359"></A> is the class for tilings
    of frames.
  
</DD>
<DT><STRONG>WSplit</STRONG></DT>
<DD><A NAME="360"></A> (or, more specifically, classes
    that inherit it) encode the WTiling tree structure.
</DD>
</DL>

<P>
Classes implemented by the <SPAN  CLASS="textit">mod_query</SPAN> module:

<P>
<DL>
<DT><STRONG>WInput</STRONG></DT>
<DD><A NAME="362"></A> is a virtual base class for the
    two classes below.
  
</DD>
<DT><STRONG>WEdln</STRONG></DT>
<DD><A NAME="363"></A> is the class for the ``queries'',
    the text inputs that usually appear at bottoms of frames and sometimes
    screens. Queries are the functional equivalent of ``mini buffers'' in
    many text editors.
  
</DD>
<DT><STRONG>WMessage</STRONG></DT>
<DD><A NAME="364"></A> implements the boxes for 
    warning and other messages that Notion may wish to display to the user. 
    These also usually appear at bottoms of frames.
</DD>
</DL>

<P>
There are also some other ``proxy'' classes that do not refer
to objects on the screen. The only important one of these for
basic configuration is WMoveresMode that is used for
binding callbacks in the move and resize mode.

<P>

<H3><A NAME="SECTION00021300000000000000">
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN> Run-time access to types</A>
</H3>

<P>
Even though it often indicates a design mistake, sometimes it can be useful to
have run-time access to the types of objects.

<P>
For example, to check wether a given object is of type WMPlex, the 
following C code can be used:

<P>
<PRE>
    if(obj_is((Obj*)cwin, &amp;CLASSDESCR(WMPlex)))
        ....
</PRE>

<P>
Its lua counterpart is:

<P>
<PRE>
    if(obj_is(cwin, "WMPlex"))
        ....
</PRE>

<P>
While there's also an 'obj_cast' method available, C structs can be freely 
cast to their 'superclass' using a regular C cast, for example:

<P>
<PRE>
bool input_fitrep(WInput *input, WWindow *par, const WFitParams *fp)
{
    if(par!=NULL &amp;&amp; !region_same_rootwin((WRegion*)input, (WRegion*)par))
        return FALSE;
    ...
</PRE>

<P>

<H2><A NAME="SECTION00022000000000000000">
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN> Object hierarchies: WRegion parents and managers</A>
</H2>

<P>

<H3><A NAME="SECTION00022100000000000000">
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Parent-child relations</A>
</H3>
Each object of type WRegion has a parent and possibly a manager
associated to it. The parent<A NAME="306"></A> for an object is always a 
WWindow and for WRegion with an X window (WClientWin,
WWindow) the parent WWindow is given by the same relation of
the X windows. For other WRegions the relation is not as clear.
There is generally very few restrictions other than the above on the
parent--child relation but the most common is as described in
paragraph <A HREF="#par:parentship"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>

<H4><A NAME="SECTION00022110000000000000"></A>
<A NAME="par:parentship"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN> Most common parent-child relations
</H4>

<P>
<PRE>
    WRootWins
     |--&gt;WGroupWSs
     |--&gt;WTilings
     |--&gt;WClientWins in full screen mode
     `--&gt;WFrames
          |--&gt;WGroupCWs
          |--&gt;WClientWins
          |--&gt;WFrames for transients
          `--&gt;a possible WEdln or WMessage
</PRE>

<P>

<H3><A NAME="SECTION00022200000000000000">
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN> Manager-managed relations</A>
</H3>

<P>
WRegions have very little control over their children as a parent.
The manager<A NAME="320"></A> WRegion has much more control over its
managed WRegions. Managers, for example, handle resize requests,
focusing and displaying of the managed regions. Indeed the manager--managed
relationship gives a better picture of the logical ordering of objects on
the screen. Again, there are generally few limits, but the most common
hierarchy is given in Figure <A HREF="#fig:managership"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>. Note that sometimes
the parent and manager are the same object and not all regions may have
a manager, but all non-screen regions have a parent--a screen if not 
anything else.

<P>

<H4><A NAME="SECTION00022210000000000000"></A>
<A NAME="par:managership"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Most common manager-managed relations
</H4>
<PRE>
    WRootWins
     |--&gt;WGroupCWs for full screen WClientWins
     |    |--&gt;WClientWins
     |    `--&gt;WFrames for transients (dialogs)
     |         `--&gt; WClientWin
     |--&gt;WGroupWSs for workspaces
     |    |--&gt;WTiling
     |    |    |--&gt;WFrames
     |    |    |    `--&gt;WGroupCWs (with contents as above)
     |    |    `--&gt;possibly a WStatusBar or WDock
     |    |--&gt;WFrames for floating content
     |    |--&gt;possibly a WEdln, WMessage or WMenu
     |    `--&gt;possibly a WStatusBar or WDock (if no tiling)
     `--&gt;WFrames for sticky stuff, such as the scratchpad
</PRE>

<P>
Note that a workspace can manage another workspace. This can be
achieved with the <TT>WGroup.attach_new</TT> function, and allows you to nest
workspaces as deep as you want.

<P>
In the presense of Xinerama<A NAME="329"></A> there may be WScreen 
objects at the top of the manager-managed tree instead of WRootWin.

<P>

<H2><A NAME="SECTION00023000000000000000">
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN> Summary</A>
</H2>

<P>
In the standard setup, keeping queries, messages and menus out of
consideration:

<P>

<UL>
<LI>The top-level objects that matter are screens and they correspond
    to physical screens. The class for screens is WScreen.
</LI>
<LI>Screens contain (multiplex) groups (WGroup) and other 
    objects, such as WFrames. Some of these are mutually exclusive
    to be viewed at a time.
</LI>
<LI>Groups of the specific kind WGroupWS often contain a
    WTiling tiling for tiling frames (WFrame), but 
    groups may also directly contain floating frames.
</LI>
<LI>Frames are the objects with decorations such as tabs and borders.
    Frames contain (multiplex) among others (groups of) client windows, 
    to each of which corresponds a tab in the frame's decoration. Only 
    one client window (or other object) can be shown at a time in each 
    frame. The class for client windows is WClientWin.
</LI>
</UL>

<P>
<BR><HR><H4>Footnotes</H4>
<DL>
<DT><A NAME="foot231">... design</A><A
 HREF="node2.html#tex2html5"><SUP><SPAN CLASS="arabic">1</SPAN></SUP></A></DT>
<DD>the 
author doesn't like such artificial designs

</DD>
</DL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html106"
  HREF="node3.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html100"
  HREF="notionnotes.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html94"
  HREF="node1.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html102"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html104"
  HREF="node10.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html107"
  HREF="node3.html">2 Object system implementation</A>
<B> Up:</B> <A NAME="tex2html101"
  HREF="notionnotes.html">Notion: Notes for the</A>
<B> Previous:</B> <A NAME="tex2html95"
  HREF="node1.html">Contents</A>
 &nbsp; <B>  <A NAME="tex2html103"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html105"
  HREF="node10.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
